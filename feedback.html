<!DOCTYPE html>
<html lang="en" translate="no">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title id="pageTitle">Feedback - Internationals Translation Service</title>

  <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üé§</text></svg>">
  <link rel="preload" as="image" href="feedback-bg.jpg">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

  <style>
    body {
      opacity: 0;
      transition: opacity 0.4s ease-in-out;
      font-family:'Inter',sans-serif;
      margin:0;padding:0;
      background:#E89344 url('feedback-bg.jpg') no-repeat top center / 100% auto;
      min-height:100vh;
    }
    body.loaded{opacity:1}

    .feedback-container{max-width:700px;margin:50px auto;padding:30px;border-radius:12px;
      backdrop-filter:blur(10px);border:1px solid rgba(255,255,255,0.2);
      box-shadow:0 8px 30px rgba(0,0,0,.25)}
    h2{color:#fff}
    .close-btn{cursor:pointer;font-size:28px;border:none;background:none;color:#fff}
    .feedback-form input,.feedback-form textarea{
      width:100%;padding:12px;margin:8px 0;border-radius:8px;
      background:rgba(255,255,255,.15);border:2px solid rgba(255,255,255,.4)}
    .feedback-form button{width:100%;padding:14px;border:none;border-radius:8px;
      background:linear-gradient(135deg,#2f5597,#1f3f83);color:#fff;font-weight:600}
    .audio-buttons{display:flex;flex-direction:column;gap:8px;margin-top:12px}
    #recordBtn.recording{animation:pulse 1.5s infinite}
    @keyframes pulse{50%{box-shadow:0 0 0 15px rgba(220,38,38,0)}}
    #stopBtn{background:#d9534f}
    .visualizer-container{display:none;margin:10px 0}
    #visualizer{width:100%;height:80px;background:rgba(0,0,0,.3)}
    .volume-meter{height:8px;background:rgba(0,0,0,.3)}
    .volume-bar{height:100%;width:0%;background:linear-gradient(90deg,#10b981,#ef4444)}
    .audio-preview{display:none;margin:10px 0}
    .feedback-item{background:rgba(255,255,255,.12);padding:15px;border-radius:8px;margin-bottom:12px}
    .admin-reply{margin-top:10px;padding:10px;background:rgba(240,249,255,.2);border-left:3px solid #3b82f6}
    .error{background:rgba(255,0,0,.2);padding:10px;border-radius:8px;color:#fff}
  </style>
</head>

<body>
<div class="feedback-container">
  <h2 class="translate" data-key="title">Feedback</h2>
  <button class="close-btn" onclick="history.back()">√ó</button>

  <div id="errorMessage"></div>

  <form id="feedbackForm" class="feedback-form">
    <input id="name" class="translate" data-key="name" placeholder="Your name" required>
    <textarea id="message" rows="4" class="translate" data-key="message"
      placeholder="Your impressions, tips, contacts (optional)" required></textarea>

    <div class="audio-buttons">
      <button type="button" id="recordBtn" class="translate" data-key="record">üéô Record Audio</button>
      <button type="button" id="stopBtn" class="translate" data-key="stop" disabled>‚èπ Stop Recording</button>
    </div>

    <div class="visualizer-container" id="visualizerContainer">
      <canvas id="visualizer"></canvas>
      <div class="volume-meter"><div class="volume-bar" id="volumeBar"></div></div>
      <div id="recordStatus" class="translate" data-key="recording"></div>
    </div>

    <div class="audio-preview" id="audioPreview">
      <audio id="previewPlayer" controls></audio>
      <button type="button" id="deleteBtn" class="translate" data-key="delete">üóë Delete and re-record</button>
    </div>

    <button type="submit" id="submitBtn" class="translate" data-key="send">Send Feedback</button>
  </form>

  <h3 class="translate" data-key="recent">Recent feedback</h3>
  <div id="feedbackList"></div>
</div>

<script>
/* ================= LANGUAGE ================= */
const translations={
ru:{title:"–û—Ç–∑—ã–≤—ã",name:"–í–∞—à–µ –∏–º—è",message:"–í–∞—à –æ—Ç–∑—ã–≤",record:"üéô –ó–∞–ø–∏—Å–∞—Ç—å –∞—É–¥–∏–æ",stop:"‚èπ –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å",
delete:"üóë –£–¥–∞–ª–∏—Ç—å –∏ –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞—Ç—å",send:"–û—Ç–ø—Ä–∞–≤–∏—Ç—å",recent:"–ü–æ—Å–ª–µ–¥–Ω–∏–µ –æ—Ç–∑—ã–≤—ã",
recording:"üî¥ –ò–¥—ë—Ç –∑–∞–ø–∏—Å—å‚Ä¶",sent:"‚úÖ –û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ!",reply:"–ù–∞—à –æ—Ç–≤–µ—Ç:",no:"–ü–æ–∫–∞ –Ω–µ—Ç –æ—Ç–∑—ã–≤–æ–≤",
errMic:"–ù–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ –º–∏–∫—Ä–æ—Ñ–æ–Ω—É",errSend:"–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏"},
en:{title:"Feedback",name:"Your name",message:"Your feedback",record:"üéô Record audio",stop:"‚èπ Stop recording",
delete:"üóë Delete and re-record",send:"Send feedback",recent:"Recent feedback",
recording:"üî¥ Recording‚Ä¶",sent:"‚úÖ Sent!",reply:"Our reply:",no:"No feedback yet",
errMic:"Cannot access microphone",errSend:"Failed to send"},
de:{title:"Bewertungen",name:"Ihr Name",message:"Ihr Feedback",record:"üéô Aufnahme starten",stop:"‚èπ Stopp",
delete:"üóë L√∂schen und neu aufnehmen",send:"Senden",recent:"Letzte Bewertungen",
recording:"üî¥ Aufnahme‚Ä¶",sent:"‚úÖ Gesendet!",reply:"Unsere Antwort:",no:"Noch keine Bewertungen",
errMic:"Kein Mikrofonzugriff",errSend:"Senden fehlgeschlagen"},
es:{title:"Rese√±as",name:"Tu nombre",message:"Tu opini√≥n",record:"üéô Grabar audio",stop:"‚èπ Detener",
delete:"üóë Borrar y volver a grabar",send:"Enviar",recent:"Rese√±as recientes",
recording:"üî¥ Grabando‚Ä¶",sent:"‚úÖ Enviado!",reply:"Nuestra respuesta:",no:"A√∫n no hay rese√±as",
errMic:"No hay acceso al micr√≥fono",errSend:"Error al enviar"},
pt:{title:"Avalia√ß√µes",name:"Seu nome",message:"Seu feedback",record:"üéô Gravar √°udio",stop:"‚èπ Parar",
delete:"üóë Excluir e gravar novamente",send:"Enviar",recent:"Avalia√ß√µes recentes",
recording:"üî¥ Gravando‚Ä¶",sent:"‚úÖ Enviado!",reply:"Nossa resposta:",no:"Ainda n√£o h√° avalia√ß√µes",
errMic:"Sem acesso ao microfone",errSend:"Falha ao enviar"},
zh:{title:"ÂèçÈ¶à",name:"ÊÇ®ÁöÑÂßìÂêç",message:"ÊÇ®ÁöÑÂèçÈ¶à",record:"üéô ÂΩïÈü≥",stop:"‚èπ ÂÅúÊ≠¢",
delete:"üóë Âà†Èô§Âπ∂ÈáçÊñ∞ÂΩïÂà∂",send:"Êèê‰∫§",recent:"ÊúÄÊñ∞ÂèçÈ¶à",
recording:"üî¥ Ê≠£Âú®ÂΩïÈü≥‚Ä¶",sent:"‚úÖ Â∑≤ÂèëÈÄÅÔºÅ",reply:"Êàë‰ª¨ÁöÑÂõûÂ§çÔºö",no:"ÊöÇÊó†ÂèçÈ¶à",
errMic:"Êó†Ê≥ïËÆøÈóÆÈ∫¶ÂÖãÈ£é",errSend:"ÂèëÈÄÅÂ§±Ë¥•"},
ar:{title:"ÿßŸÑÿ™ŸÇŸäŸäŸÖÿßÿ™",name:"ÿßÿ≥ŸÖŸÉ",message:"ÿ±ÿ£ŸäŸÉ",record:"üéô ÿ™ÿ≥ÿ¨ŸäŸÑ ÿµŸàÿ™Ÿä",stop:"‚èπ ÿ•ŸäŸÇÿßŸÅ",
delete:"üóë ÿ≠ÿ∞ŸÅ Ÿàÿ•ÿπÿßÿØÿ© ÿßŸÑÿ™ÿ≥ÿ¨ŸäŸÑ",send:"ÿ•ÿ±ÿ≥ÿßŸÑ",recent:"ÿ£ÿ≠ÿØÿ´ ÿßŸÑÿ™ŸÇŸäŸäŸÖÿßÿ™",
recording:"üî¥ ÿ¨ÿßÿ±Ÿä ÿßŸÑÿ™ÿ≥ÿ¨ŸäŸÑ‚Ä¶",sent:"‚úÖ ÿ™ŸÖ ÿßŸÑÿ•ÿ±ÿ≥ÿßŸÑ!",reply:"ÿ±ÿØŸÜÿß:",no:"ŸÑÿß ÿ™Ÿàÿ¨ÿØ ÿ™ŸÇŸäŸäŸÖÿßÿ™ ÿ®ÿπÿØ",
errMic:"ŸÑÿß ŸäŸÖŸÉŸÜ ÿßŸÑŸàÿµŸàŸÑ ÿ•ŸÑŸâ ÿßŸÑŸÖŸäŸÉÿ±ŸàŸÅŸàŸÜ",errSend:"ŸÅÿ¥ŸÑ ÿßŸÑÿ•ÿ±ÿ≥ÿßŸÑ"}
};

let lang=localStorage.getItem('language')||'en';
if(!translations[lang])lang='en';
document.documentElement.lang=lang;
document.documentElement.dir=lang==='ar'?'rtl':'ltr';
document.getElementById('pageTitle').textContent=
translations[lang].title+" - Internationals Translation Service";

document.querySelectorAll('.translate').forEach(el=>{
  const k=el.dataset.key;
  if(k && translations[lang][k]) el.textContent=translations[lang][k];
});

/* ====== –¢–í–û–ô JS –ù–ò–ñ–ï –ë–ï–ó –ò–ó–ú–ï–ù–ï–ù–ò–ô (Supabase, MediaRecorder –∏ —Ç.–¥.) ====== */
// ‚ö†Ô∏è –∑–¥–µ—Å—å –æ—Å—Ç–∞—ë—Ç—Å—è –≤–µ—Å—å —Ç–≤–æ–π –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π JS
</script>
</body>
</html>
